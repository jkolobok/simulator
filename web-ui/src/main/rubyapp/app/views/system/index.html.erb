<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>New System</title>
    <link rel="stylesheet" type="text/css" href="../ext/resources/css/ext-all.css"/>
    <script type="text/javascript" src="../javascripts/tk-base.js"></script>
    <script type="text/javascript" src="../ext/adapter/ext/ext-base-debug.js"></script>
    <script type="text/javascript" src="../ext/ext-all-debug.js"></script>
    <script type="text/javascript" src="../javascripts/system.js"></script>
</head>
<body>
<script type="text/javascript">
    Ext.onReady(function()
    {
        Ext.QuickTips.init();

        // turn on validation errors beside the field globally
        Ext.form.Field.prototype.msgTarget = 'side';
        var systemDataFor = new TK.SystemForm({
            systemId: '<%= params[:system_id] %>'
        });
        systemDataFor.render(document.getElementById('system'));

        var store = new Ext.data.ArrayStore({
            url: 'conversation/list?system_id<%= params[:system_id] %>',
            root:'conversations',
            storeId:'conversationStore',
            idProperty:'name',
            fields: ['name', 'description']
        });

        var conversationsGrid = new Ext.grid.GridPanel({            
            height: 200,
            width: '100%',
            store: store,
            columns: [
                {
                    id:'name',
                    header: 'Name',
                    width: 160,
                    sortable: true,
                    dataIndex: 'company'
                },
                {
                    header: 'Description',
                    width: 75,
                    dataIndex: 'description'
                }
            ],
            stripeRows: true,
            autoExpandColumn: 'company',

            title: 'Array Grid',
            // config options for stateful behavior
            stateful: true,
            stateId: 'grid'
        });
        conversationsGrid.render(document.getElementById('conversation'))
    })


</script>


<div id="system">
</div>

<div id="conversation" style="width: 100%; height: 50%">
</div>

</body>
</html>